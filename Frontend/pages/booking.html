<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Your Trip - Highway Bus Booking</title>
    
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/booking.css">
    <!-- Bootstrap CSS and Font Awesome for icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<!-- Navbar -->
<div id="navbar-container"></div>


<!-- Booking Section -->
<section class="booking-section py-5">
    <div class="container">
        <h2 class="text-center mb-4">Book Your Highway Bus Trip</h2>

        <!-- Search Bar -->
        <div class="search-bar mb-5">
            <form class="row g-3">
                <div class="col-md-4">
                    <label for="origin" class="form-label">Origin</label>
                    <select class="form-control" id="origin">
                        <option value="" selected disabled>Select starting location</option>
                        <option value="Colombo">Colombo</option>
                        <option value="Galle">Galle</option>
                        <option value="Kandy">Kandy</option>
                        <option value="Jaffna">Jaffna</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="destination" class="form-label">Destination</label>
                    <select class="form-control" id="destination">
                        <option value="" selected disabled>Select destination</option>
                        <option value="Colombo">Colombo</option>
                        <option value="Galle">Galle</option>
                        <option value="Kandy">Kandy</option>
                        <option value="Jaffna">Jaffna</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="date" class="form-label">Date of Travel</label>
                    <input type="date" class="form-control" id="date">
                </div>
            </form>
        </div>

        <!-- Available Buses -->
        <div class="available-buses mb-5">
            <h3>Available Buses</h3>
            <div class="bus-list mt-4">
                <p>Select an origin and destination to view available buses.</p>
            </div>
        </div>

        <!-- Seat Selection Modal -->
        <div class="modal fade" id="seatSelectionModal" tabindex="-1" aria-labelledby="seatSelectionModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="seatSelectionModalLabel">Select Your Seats</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="seat-map">
                            <div class="seat-row">
                                <span class="seat available">1</span>
                                <span class="seat reserved">2</span>
                                <span class="seat available">3</span>
                                <span class="seat available">4</span>
                            </div>
                        </div>
                        <p class="mt-3">Selected Seats: <span id="selected-seats"></span></p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Confirm Seats</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Booking Summary -->
        <div class="booking-summary mt-5">
            <h3>Booking Summary</h3>
            <p>Route: <span id="route"></span></p>
            <p>Date: <span id="travel-date"></span></p>
            <p>Seats: <span id="seat-numbers"></span></p>
            <p>Total Cost: $<span id="total-cost"></span></p>
            <button class="btn btn-success">Proceed to Payment</button>
        </div>
    </div>
</section>


<div id="footer-container"></div>

<!-- Bootstrap JS Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/booking.js"></script>
<script>
    // Dynamically load the navbarand footer component
    document.addEventListener("DOMContentLoaded", () => {
            const navbarContainer = document.getElementById("navbar-container");
            const footerContainer =document.getElementById("footer-container");
            fetch("/components/navbar.html")
                .then((response) => response.text())
                .then((html) => {
                    navbarContainer.innerHTML = html;
                })
                .catch((error) => {
                    console.error("Error loading the navbar:", error);
                });

            fetch("/components/footer.html")
                .then((response) => response.text())
                .then((html) => {
                    footerContainer.innerHTML = html;
                })
                .catch((error) => {
                    console.error("Error loading the footer:", error);
                });


        });
</script>
<script>
    document.addEventListener("DOMContentLoaded", () => {
    const originDropdown = document.getElementById("origin");
    const destinationDropdown = document.getElementById("destination");
    const busList = document.querySelector(".bus-list");

    const buses = [
        { id: 1, route: "Colombo to Galle", departure: "10:00 AM", arrival: "12:30 PM", price: 20 },
        { id: 2, route: "Colombo to Kandy", departure: "8:00 AM", arrival: "11:00 AM", price: 15 },
        { id: 3, route: "Galle to Colombo", departure: "3:00 PM", arrival: "5:30 PM", price: 20 },
        { id: 4, route: "Kandy to Jaffna", departure: "6:00 AM", arrival: "2:00 PM", price: 50 }
    ];

    const updateBusList = () => {
        const origin = originDropdown.value;
        const destination = destinationDropdown.value;

        busList.innerHTML = "";

        buses
            .filter(bus => bus.route.toLowerCase().includes(`${origin} to ${destination}`.toLowerCase()))
            .forEach(bus => {
                const card = `
                <div class="card mb-3">
                    <div class="card-body">
                        <h5 class="card-title">${bus.route}</h5>
                        <p class="card-text">Departure: ${bus.departure} | Arrival: ${bus.arrival}</p>
                        <p class="card-text">Price per seat: $${bus.price}</p>
                        <button class="btn btn-outline-primary select-seat-btn" data-bs-toggle="modal" data-bs-target="#seatSelectionModal" data-route="${bus.route}">Select Seats</button>
                    </div>
                </div>`;
                busList.innerHTML += card;
            });

        if (busList.innerHTML === "") {
            busList.innerHTML = "<p>No buses available for the selected route.</p>";
        }
    };

    originDropdown.addEventListener("change", updateBusList);
    destinationDropdown.addEventListener("change", updateBusList);

    document.addEventListener("click", (e) => {
        if (e.target.classList.contains("select-seat-btn")) {
            const route = e.target.getAttribute("data-route");
            document.getElementById("route").textContent = route;
        }
    });
});

</script>
</body>
</html>
